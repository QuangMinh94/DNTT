Screen4 As screen:
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)

    ButtonCanvas2 As Button:
        DisplayMode: =DisplayMode.Edit
        Height: =32
        OnSelect: |-
            =With(
                {
                    varResultXML: Getfilefrompowerapp.Run(
                        {
                            contentBytes: Last(DataCardValue14_14.Attachments).Value,
                            name: Last(DataCardValue14_14.Attachments).Name
                        }
                    )
                },
                Concurrent(
                    UpdateContext({varOutputJson: ParseJSON(varResultXML.outputjson)}),
                    UpdateContext({varOutputType: varResultXML.outputtype})
                );
                Patch(
                    colAttachmentInvoices, 
                    Defaults(colAttachmentInvoices),
                    {
                        TaxsRef: With(
                            {
                                colAddRowTaxs:
                                AddColumns(
                                    Table(varOutputJson.Tax),
                                    ID, "",
                                    TaxAmount, Value(ThisRecord.Value.TaxAmount),
                                    TaxType, Text(ThisRecord.Value.TaxType),
                                    TaxableIncome, Value(ThisRecord.Value.TaxableIncome)
                                )
                                
                            },
                            Ungroup(
                                ForAll(
                                    Sequence(CountRows(colAddRowTaxs)),
                                    {
                                        myRecord: Table(
                                            Last(
                                                FirstN(
                                                    colAddRowTaxs,
                                                    Value
                                                )
                                            )
                                        ),
                                        RowNumber: Value
                                    }
                                ),
                                myRecord
                            )
                        )
                    }
                )
                
            );
        Width: =96
        X: =846
        Y: =180
        ZIndex: =2

    "Gallery4 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
        BorderColor: =RGBA(245, 245, 245, 1)
        DelayItemLoading: =true
        Height: =631
        Items: =Attachments
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =0
        TemplateSize: =104
        Width: =818
        X: =40
        Y: =40
        ZIndex: =3

        Image10 As image:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =72
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =72
            X: =16
            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            ZIndex: =1

        Title3 As label:
            Color: =RGBA(50, 49, 48, 1)
            DisabledColor: =RGBA(161, 159, 157, 1)
            Font: =Font.'Segoe UI'
            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
            Height: =Self.Size * 1.8
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =12
            PaddingRight: =0
            PaddingTop: =0
            Text: =ThisItem.Title
            VerticalAlign: =VerticalAlign.Top
            Width: =Parent.TemplateWidth - 173
            X: =103
            Y: =(Parent.TemplateHeight - (Self.Size * 1.8 + Subtitle3.Size * 1.8)) / 2
            ZIndex: =2

        Subtitle3 As label:
            Color: =RGBA(96, 94, 92, 1)
            DisabledColor: =RGBA(161, 159, 157, 1)
            Font: =Font.'Segoe UI'
            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
            Height: =24
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =12
            PaddingRight: =0
            PaddingTop: =0
            Size: =12
            Text: =ThisItem.FileType
            VerticalAlign: =VerticalAlign.Top
            Width: =162
            X: =88
            Y: =16
            ZIndex: =3

        NextArrow3 As icon.ChevronRight:
            AccessibleLabel: =Self.Tooltip
            Color: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Height: =50
            Icon: =Icon.ChevronRight
            OnSelect: =Select(Parent)
            PaddingBottom: =16
            PaddingLeft: =16
            PaddingRight: =16
            PaddingTop: =16
            Tooltip: ="View item details"
            Width: =50
            X: =Parent.TemplateWidth - Self.Width - 12
            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            ZIndex: =4

        Separator1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =8
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - Self.Height
            ZIndex: =5

        Rectangle3 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 120, 212, 1)
            Height: =Parent.TemplateHeight - Separator1.Height
            OnSelect: =Select(Parent)
            Visible: =ThisItem.IsSelected
            Width: =4
            ZIndex: =6

        ComboBox2 As combobox:
            BorderColor: =RGBA(245, 245, 245, 1)
            ChevronBackground: =RGBA(245, 245, 245, 1)
            ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
            ChevronDisabledFill: =RGBA(161, 159, 157, 1)
            ChevronFill: =RGBA(50, 49, 48, 1)
            ChevronHoverBackground: =RGBA(245, 245, 245, 1)
            ChevronHoverFill: =RGBA(50, 49, 48, 1)
            Color: =RGBA(50, 49, 48, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(161, 159, 157, 1)
            DisabledFill: =RGBA(242, 242, 241, 0)
            DisplayFields: =["Description"]
            Fill: =RGBA(245, 245, 245, 1)
            Font: =Font.'Segoe UI'
            Height: =52
            HoverBorderColor: =RGBA(16, 110, 190, 1)
            HoverColor: =RGBA(50, 49, 48, 1)
            HoverFill: =RGBA(245, 245, 245, 1)
            Items: =Filter(Categories, CategoryType = "INVOICE_TYPE")
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(16, 110, 190, 1)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(0, 120, 212, 1)
            SearchFields: =["Description"]
            SearchItems: =Search(Filter(Categories, CategoryType = "INVOICE_TYPE"),ComboBox2.SearchText,Description)
            SelectionFill: =RGBA(0, 120, 212, 1)
            Size: =13
            X: =277
            Y: =37
            ZIndex: =7

